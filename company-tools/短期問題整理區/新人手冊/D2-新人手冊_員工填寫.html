<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - å“¡å·¥å¡«å¯«ç‰ˆ</title>
    <style>
        /* åŸºç¤æ¨£å¼ */
        body {
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            margin: 30px auto;
            max-width: 1400px;
            font-size: 14pt;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .report-title {
            text-align: center;
            font-size: 20pt;
            font-weight: bold;
            margin-bottom: 20px;
            color: #2c3e50;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: auto;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            word-break: keep-all;
            overflow-wrap: break-word;
            white-space: normal;
            font-size: 13pt;
            line-height: 1.6;
        }
        th {
            background-color: #34495e;
            color: white;
            font-weight: bold;
        }
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            font-size: 15pt;
        }
        .quality-cell {
            background-color: #b3e5fc;
        }
        /* æ”¾å¤§å‹¾é¸æ¡† */
        .quality-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-right: 5px;
            vertical-align: middle;
        }
        .quality-label {
            display: inline-block;
            margin-right: 15px;
            font-size: 12pt;
            white-space: nowrap;
        }
        .manager-review {
            background-color: #fff3cd;
        }
        tbody tr:hover {
            background-color: #f8f9fa;
        }
        /* è¼¸å…¥æ¡†çš„æ¨™æº–æ¨£å¼ */
        input[type="text"], input[type="date"], input[type="number"], textarea, select {
            width: 98%;
            box-sizing: border-box;
            padding: 8px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13pt;
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            transition: border-color 0.3s;
        }
        /* å”¯è®€å€åŸŸæ¨£å¼ */
        .readonly-section {
            background-color: #e8e8e8;
            position: relative;
        }
        .readonly-section input, .readonly-section select {
            background-color: #d3d3d3;
            color: #666;
            cursor: not-allowed;
            border-color: #bbb;
        }
        .readonly-note {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            font-weight: bold;
            color: #856404;
            text-align: center;
        }
        input[type="text"]:focus, input[type="date"]:focus,
        input[type="number"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        textarea {
            resize: vertical;
            min-height: 60px;
        }
        select {
            cursor: pointer;
        }
        /* å®Œæˆç‡é¡¯ç¤ºæ¨£å¼ */
        .completion-rate {
            display: inline-block;
            padding: 5px 10px;
            font-weight: bold;
            font-size: 14pt;
            border-radius: 4px;
            background-color: #f0f0f0;
        }
        /* åˆ—å°æ¨£å¼ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 8mm 6mm 8mm 6mm;
            }
            body {
                margin: 0;
                padding: 0;
                font-size: 9pt;
                background-color: white;
                max-width: none;
            }
            .report-title {
                font-size: 14pt;
                font-weight: bold;
                margin-bottom: 8px;
                box-shadow: none;
                border-radius: 0;
                padding: 8px;
                border: 2px solid #2c3e50;
                background-color: #ecf0f1;
                color: #2c3e50;
            }
            table {
                box-shadow: none;
                border-radius: 0;
                margin-bottom: 12px;
                border: 2px solid #333;
            }
            .section-header {
                background-color: #5a6c7d !important;
                color: white !important;
                padding: 10px !important;
                font-size: 11pt !important;
                font-weight: bold !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            th {
                background-color: #34495e !important;
                color: white !important;
                font-weight: bold !important;
                padding: 5px 6px !important;
                font-size: 9pt !important;
                border: 1px solid #2c3e50 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            td {
                padding: 4px 6px;
                word-wrap: break-word;
                word-break: keep-all;
                overflow-wrap: break-word;
                white-space: normal;
                font-size: 8.5pt;
                line-height: 1.4;
                border: 1px solid #666 !important;
            }
            .quality-cell {
                background-color: #b3e5fc !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .manager-review {
                background-color: #fff3cd !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .completion-rate {
                padding: 2px 5px;
                font-size: 9pt;
            }
            .readonly-note {
                display: none !important;
            }
            input[type="text"], input[type="date"], input[type="number"], textarea, select {
                border: none !important;
                background: none !important;
                padding: 0 !important;
                color: black !important;
                height: auto !important;
            }
            /* åˆ—å°æ™‚é¡¯ç¤ºcheckbox */
            input[type="checkbox"] {
                width: 16px;
                height: 16px;
                margin-right: 3px;
                vertical-align: middle;
            }
            .quality-label {
                font-size: 9pt;
                margin-right: 10px;
            }
            .submit-container, button {
                display: none !important;
            }
            table {
                page-break-inside: auto;
                table-layout: auto;
            }
            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
    <script>
        // è¨­å®šæ—¥æœŸç‚ºä»Šå¤©
        window.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const dateString = `${year}-${month}-${day}`;
            document.querySelector('input[name="report_date"]').value = dateString;

            // è¨ˆç®—å®Œæˆç‡
            function calculateCompletionRate() {
                const tasks = ['rcv', 'exc', 'rma', 'rtp', 'pac', 'sec', 'inv', 'snk', 'cnt', 'stk'];
                tasks.forEach(task => {
                    const targetInput = document.querySelector(`.target-input[data-task="${task}"]`);
                    const actualInput = document.querySelector(`.actual-input[data-task="${task}"]`);
                    const rateSpan = document.querySelector(`.completion-rate[data-task="${task}"]`);
                    const quality1Checkbox = document.querySelector(`input[name="actual_${task}_quality_1"]`);
                    const quality2Checkbox = document.querySelector(`input[name="actual_${task}_quality_2"]`);

                    if (targetInput && actualInput && rateSpan) {
                        const target = parseFloat(targetInput.value) || 0;
                        const actual = parseFloat(actualInput.value) || 0;
                        const quality1Checked = quality1Checkbox ? quality1Checkbox.checked : false;
                        const quality2Checked = quality2Checkbox ? quality2Checkbox.checked : false;

                        // æª¢æŸ¥ç•°å¸¸ï¼šä¸»ç®¡æ²’è¨­å®šé è¨ˆæ•¸é‡ï¼Œä½†å“¡å·¥å¡«äº†å¯¦éš›æ•¸é‡æˆ–å‹¾é¸äº†å“è³ªæª¢æ ¸
                        if (target === 0 && (actual > 0 || quality1Checked || quality2Checked)) {
                            rateSpan.textContent = 'âš ï¸ ç•°å¸¸';
                            rateSpan.style.color = '#1565c0';
                            rateSpan.style.fontWeight = 'bold';
                            actualInput.style.backgroundColor = '#e3f2fd';
                            actualInput.style.border = '2px solid #2196f3';
                            // æ¨™è¨˜å“è³ªæª¢æ ¸å‹¾é¸æ¡†
                            if (quality1Checkbox) {
                                quality1Checkbox.parentElement.style.backgroundColor = '#e3f2fd';
                                quality1Checkbox.parentElement.style.padding = '5px 8px';
                                quality1Checkbox.parentElement.style.borderRadius = '4px';
                            }
                            if (quality2Checkbox) {
                                quality2Checkbox.parentElement.style.backgroundColor = '#e3f2fd';
                                quality2Checkbox.parentElement.style.padding = '5px 8px';
                                quality2Checkbox.parentElement.style.borderRadius = '4px';
                            }
                            return;
                        } else {
                            // æ¢å¾©æ­£å¸¸æ¨£å¼
                            actualInput.style.backgroundColor = '';
                            actualInput.style.border = '2px solid #e0e0e0';
                            if (quality1Checkbox) {
                                quality1Checkbox.parentElement.style.backgroundColor = '';
                                quality1Checkbox.parentElement.style.padding = '';
                                quality1Checkbox.parentElement.style.borderRadius = '';
                            }
                            if (quality2Checkbox) {
                                quality2Checkbox.parentElement.style.backgroundColor = '';
                                quality2Checkbox.parentElement.style.padding = '';
                                quality2Checkbox.parentElement.style.borderRadius = '';
                            }
                        }

                        if (target > 0) {
                            const rate = Math.round((actual / target) * 100);
                            rateSpan.textContent = rate + '%';

                            // æ ¹æ“šå®Œæˆç‡æ”¹è®Šé¡è‰²
                            if (rate >= 100) {
                                rateSpan.style.color = 'green';
                                rateSpan.style.fontWeight = 'bold';
                            } else if (rate >= 80) {
                                rateSpan.style.color = 'orange';
                                rateSpan.style.fontWeight = 'bold';
                            } else {
                                rateSpan.style.color = 'red';
                                rateSpan.style.fontWeight = 'bold';
                            }
                        } else {
                            rateSpan.textContent = '0%';
                            rateSpan.style.color = 'black';
                        }
                    }
                });
            }

            // ç›£è½æ‰€æœ‰è¼¸å…¥æ¡†
            document.querySelectorAll('.target-input, .actual-input').forEach(input => {
                input.addEventListener('input', calculateCompletionRate);
            });

            // ç›£è½æ‰€æœ‰å“è³ªæª¢æ ¸å‹¾é¸æ¡†
            document.querySelectorAll('.quality-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', calculateCompletionRate);
            });

            // åŒ¯å…¥ä¸»ç®¡è³‡æ–™
            window.importManagerData = function() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const data = JSON.parse(event.target.result);

                            // å¡«å…¥åŸºæœ¬è³‡è¨Š
                            document.querySelector('input[name="week_number"]').value = data.week_number || '';
                            document.querySelector('input[name="new_hire_name"]').value = data.new_hire_name || '';
                            document.querySelector('input[name="report_date"]').value = data.report_date || '';
                            document.querySelector('input[name="manager_name"]').value = data.manager_name || '';
                            document.querySelector('input[name="hours_worked"]').value = data.hours_worked || '';

                            // å¡«å…¥ä»»å‹™è³‡æ–™
                            const tasks = data.tasks || {};
                            ['rcv', 'exc', 'rma', 'rtp', 'pac', 'sec', 'inv', 'snk', 'cnt', 'stk'].forEach(task => {
                                if (tasks[task]) {
                                    document.querySelector(`input[name="commit_${task}_task"]`).value = tasks[task].task || '';
                                    document.querySelector(`input[name="commit_${task}_target"]`).value = tasks[task].target || '';
                                    document.querySelector(`input[name="commit_${task}_minutes"]`).value = tasks[task].minutes || '';
                                }
                            });

                            alert('âœ“ ä¸»ç®¡è³‡æ–™å·²æˆåŠŸè¼‰å…¥ï¼');
                        } catch (error) {
                            alert('âŒ æª”æ¡ˆæ ¼å¼éŒ¯èª¤ï¼Œè«‹ç¢ºèªæ˜¯å¦ç‚ºæ­£ç¢ºçš„JSONæª”æ¡ˆã€‚');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            };

            // æäº¤åˆ° Google Sheets
            window.submitToGoogleSheets = function() {
                const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzPoOQEk30yv-iDsytmw6SLPYzGv53MHnwY9oTH0F-ssGE6bKDciS-LFRcaclV9prA2/exec';

                if (SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                    alert('âš ï¸ è«‹å…ˆè¨­å®š Google Sheets URLï¼\n\nè«‹åœ¨ç¨‹å¼ç¢¼ä¸­æ‰¾åˆ° SCRIPT_URL ä¸¦æ›¿æ›æˆæ‚¨çš„ Web App URLã€‚');
                    return;
                }

                // æª¢æŸ¥æ˜¯å¦æœ‰ç•°å¸¸ï¼šä¸»ç®¡æ²’è¨­å®šé è¨ˆæ•¸é‡ï¼Œä½†å“¡å·¥å¡«äº†å¯¦éš›æ•¸é‡æˆ–å‹¾é¸å“è³ªæª¢æ ¸
                const tasks = ['rcv', 'exc', 'rma', 'rtp', 'pac', 'sec', 'inv', 'snk', 'cnt', 'stk'];
                const taskNames = {
                    'rcv': 'é€²è²¨ç°½æ”¶',
                    'exc': 'é€²è²¨ç•°å¸¸',
                    'rma': 'é€€è²¨è™•ç†',
                    'rtp': 'é€€è²¨ä¸Šæ¶',
                    'pac': 'åŒ…è£æ©Ÿæ“ä½œ',
                    'sec': 'è²¼æ¨™ï¼é»‘è²¼',
                    'inv': 'ç›¤é»',
                    'snk': 'æ‹†è›‡çš®',
                    'cnt': 'æ•¸æ•¸é‡',
                    'stk': 'é€²è²¨ä¸Šæ¶'
                };
                const anomalies = [];

                tasks.forEach(task => {
                    const target = parseFloat(document.querySelector(`.target-input[data-task="${task}"]`).value) || 0;
                    const actual = parseFloat(document.querySelector(`.actual-input[data-task="${task}"]`).value) || 0;
                    const quality1 = document.querySelector(`input[name="actual_${task}_quality_1"]`).checked;
                    const quality2 = document.querySelector(`input[name="actual_${task}_quality_2"]`).checked;
                    if (target === 0 && (actual > 0 || quality1 || quality2)) {
                        anomalies.push(taskNames[task]);
                    }
                });

                if (anomalies.length > 0) {
                    const confirmed = confirm('âš ï¸ åµæ¸¬åˆ°ç•°å¸¸æƒ…æ³\n\n' +
                        'ä»¥ä¸‹ä»»å‹™ä¸»ç®¡æ²’æœ‰è¨­å®šé è¨ˆæ•¸é‡ï¼Œä½†æ‚¨å¡«å¯«äº†å¯¦éš›æ•¸é‡æˆ–å‹¾é¸äº†å“è³ªæª¢æ ¸ï¼š\n' +
                        anomalies.map(name => 'â€¢ ' + name).join('\n') +
                        '\n\né€™å¯èƒ½è¡¨ç¤ºæ‚¨å¡«å¯«äº†ä¸åœ¨è¨ˆç•«å…§çš„ä»»å‹™ã€‚\nç¢ºå®šè¦ç¹¼çºŒæäº¤å—ï¼Ÿ');
                    if (!confirmed) {
                        return;
                    }
                }

                // æ”¶é›†æ‰€æœ‰è³‡æ–™
                const data = {
                    week_number: document.querySelector('input[name="week_number"]').value,
                    new_hire_name: document.querySelector('input[name="new_hire_name"]').value,
                    report_date: document.querySelector('input[name="report_date"]').value,
                    manager_name: document.querySelector('input[name="manager_name"]').value,
                    hours_worked: document.querySelector('input[name="hours_worked"]').value,
                    tasks: {
                        rcv: {
                            task: document.querySelector('input[name="commit_rcv_task"]').value,
                            target: document.querySelector('input[name="commit_rcv_target"]').value,
                            minutes: document.querySelector('input[name="commit_rcv_minutes"]').value
                        },
                        exc: {
                            task: document.querySelector('input[name="commit_exc_task"]').value,
                            target: document.querySelector('input[name="commit_exc_target"]').value,
                            minutes: document.querySelector('input[name="commit_exc_minutes"]').value
                        },
                        rma: {
                            task: document.querySelector('input[name="commit_rma_task"]').value,
                            target: document.querySelector('input[name="commit_rma_target"]').value,
                            minutes: document.querySelector('input[name="commit_rma_minutes"]').value
                        },
                        rtp: {
                            task: document.querySelector('input[name="commit_rtp_task"]').value,
                            target: document.querySelector('input[name="commit_rtp_target"]').value,
                            minutes: document.querySelector('input[name="commit_rtp_minutes"]').value
                        },
                        pac: {
                            task: document.querySelector('input[name="commit_pac_task"]').value,
                            target: document.querySelector('input[name="commit_pac_target"]').value,
                            minutes: document.querySelector('input[name="commit_pac_minutes"]').value
                        },
                        sec: {
                            task: document.querySelector('input[name="commit_sec_task"]').value,
                            target: document.querySelector('input[name="commit_sec_target"]').value,
                            minutes: document.querySelector('input[name="commit_sec_minutes"]').value
                        },
                        inv: {
                            task: document.querySelector('input[name="commit_inv_task"]').value,
                            target: document.querySelector('input[name="commit_inv_target"]').value,
                            minutes: document.querySelector('input[name="commit_inv_minutes"]').value
                        },
                        snk: {
                            task: document.querySelector('input[name="commit_snk_task"]').value,
                            target: document.querySelector('input[name="commit_snk_target"]').value,
                            minutes: document.querySelector('input[name="commit_snk_minutes"]').value
                        },
                        cnt: {
                            task: document.querySelector('input[name="commit_cnt_task"]').value,
                            target: document.querySelector('input[name="commit_cnt_target"]').value,
                            minutes: document.querySelector('input[name="commit_cnt_minutes"]').value
                        },
                        stk: {
                            task: document.querySelector('input[name="commit_stk_task"]').value,
                            target: document.querySelector('input[name="commit_stk_target"]').value,
                            minutes: document.querySelector('input[name="commit_stk_minutes"]').value
                        }
                    },
                    actual: {
                        rcv: {
                            output: document.querySelector('input[name="actual_rcv_output"]').value,
                            minutes: document.querySelector('input[name="actual_rcv_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_rcv_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_rcv_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="rcv"]').textContent,
                            gap: document.querySelector('input[name="actual_rcv_gap"]').value
                        },
                        exc: {
                            output: document.querySelector('input[name="actual_exc_output"]').value,
                            minutes: document.querySelector('input[name="actual_exc_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_exc_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_exc_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="exc"]').textContent,
                            gap: document.querySelector('input[name="actual_exc_gap"]').value
                        },
                        rma: {
                            output: document.querySelector('input[name="actual_rma_output"]').value,
                            minutes: document.querySelector('input[name="actual_rma_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_rma_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_rma_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="rma"]').textContent,
                            gap: document.querySelector('input[name="actual_rma_gap"]').value
                        },
                        rtp: {
                            output: document.querySelector('input[name="actual_rtp_output"]').value,
                            minutes: document.querySelector('input[name="actual_rtp_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_rtp_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_rtp_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="rtp"]').textContent,
                            gap: document.querySelector('input[name="actual_rtp_gap"]').value
                        },
                        pac: {
                            output: document.querySelector('input[name="actual_pac_output"]').value,
                            minutes: document.querySelector('input[name="actual_pac_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_pac_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_pac_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="pac"]').textContent,
                            gap: document.querySelector('input[name="actual_pac_gap"]').value
                        },
                        sec: {
                            output: document.querySelector('input[name="actual_sec_output"]').value,
                            minutes: document.querySelector('input[name="actual_sec_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_sec_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_sec_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="sec"]').textContent,
                            gap: document.querySelector('input[name="actual_sec_gap"]').value
                        },
                        inv: {
                            output: document.querySelector('input[name="actual_inv_output"]').value,
                            minutes: document.querySelector('input[name="actual_inv_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_inv_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_inv_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="inv"]').textContent,
                            gap: document.querySelector('input[name="actual_inv_gap"]').value
                        },
                        snk: {
                            output: document.querySelector('input[name="actual_snk_output"]').value,
                            minutes: document.querySelector('input[name="actual_snk_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_snk_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_snk_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="snk"]').textContent,
                            gap: document.querySelector('input[name="actual_snk_gap"]').value
                        },
                        cnt: {
                            output: document.querySelector('input[name="actual_cnt_output"]').value,
                            minutes: document.querySelector('input[name="actual_cnt_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_cnt_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_cnt_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="cnt"]').textContent,
                            gap: document.querySelector('input[name="actual_cnt_gap"]').value
                        },
                        stk: {
                            output: document.querySelector('input[name="actual_stk_output"]').value,
                            minutes: document.querySelector('input[name="actual_stk_minutes"]').value,
                            quality: (document.querySelector('input[name="actual_stk_quality_1"]').checked ? 'âœ“' : 'âœ—') + ' ' + (document.querySelector('input[name="actual_stk_quality_2"]').checked ? 'âœ“' : 'âœ—'),
                            rate: document.querySelector('.completion-rate[data-task="stk"]').textContent,
                            gap: document.querySelector('input[name="actual_stk_gap"]').value
                        }
                    },
                    questions: {
                        log1: {
                            target: document.querySelector('input[name="q_log1_target"]').value,
                            content: document.querySelector('input[name="q_log1_content"]').value,
                            solution: document.querySelector('input[name="q_log1_solution"]').value
                        },
                        log2: {
                            target: document.querySelector('input[name="q_log2_target"]').value,
                            content: document.querySelector('input[name="q_log2_content"]').value,
                            solution: document.querySelector('input[name="q_log2_solution"]').value
                        },
                        opt: {
                            target: document.querySelector('input[name="q_log_opt_target"]').value,
                            content: document.querySelector('input[name="q_log_opt_content"]').value,
                            solution: document.querySelector('input[name="q_log_opt_solution"]').value
                        },
                        learn: {
                            target: document.querySelector('input[name="q_log_learn_target"]').value,
                            content: document.querySelector('input[name="q_log_learn_content"]').value,
                            solution: document.querySelector('input[name="q_log_learn_solution"]').value
                        }
                    },
                    evaluation: {
                        discipline: {
                            score: document.querySelector('input[name="eval_discipline"]').value,
                            note: document.querySelector('input[name="eval_discipline_note"]').value
                        },
                        efficiency: {
                            score: document.querySelector('input[name="eval_efficiency"]').value,
                            note: document.querySelector('input[name="eval_efficiency_note"]').value
                        },
                        value_fit: {
                            score: document.querySelector('input[name="eval_value_fit"]').value,
                            note: document.querySelector('input[name="eval_value_fit_note"]').value
                        },
                        commitment: {
                            score: document.querySelector('input[name="eval_commitment"]').value,
                            note: document.querySelector('input[name="eval_commitment_note"]').value
                        }
                    },
                    weekly: {
                        learnings: document.querySelector('textarea[name="weekly_learnings"]').value,
                        relationship: document.querySelector('textarea[name="weekly_relationship_issues"]').value,
                        feedback: document.querySelector('textarea[name="manager_feedback"]').value
                    }
                };

                // é¡¯ç¤ºè¼‰å…¥ä¸­
                const submitBtn = event.target;
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'â³ æäº¤ä¸­...';
                submitBtn.disabled = true;

                // ç™¼é€åˆ° Google Sheets
                fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                })
                .then(() => {
                    alert('âœ“ è³‡æ–™å·²æˆåŠŸæäº¤åˆ° Google Sheetsï¼\n\nä¸»ç®¡å¯ä»¥åœ¨ Google Sheets ä¸­æŸ¥çœ‹æ‚¨çš„è³‡æ–™ã€‚');
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                })
                .catch((error) => {
                    alert('âŒ æäº¤å¤±æ•—ï¼š' + error.message + '\n\nè«‹ç¢ºèªç¶²è·¯é€£ç·šå’Œ Google Script URL æ˜¯å¦æ­£ç¢ºã€‚');
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                });
            };

            // åŒ¯å‡ºå®Œæ•´å ±è¡¨åˆ°Excel
            window.exportToExcel = function() {
                const data = [];

                // åŸºæœ¬è³‡è¨Š
                data.push(['é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - å®Œæ•´ç‰ˆ']);
                data.push(['è©¦ç”¨æœŸç¬¬', document.querySelector('input[name="week_number"]').value, 'é€±']);
                data.push([]);
                data.push(['æ–°äººå§“å', document.querySelector('input[name="new_hire_name"]').value]);
                data.push(['æ—¥æœŸ', document.querySelector('input[name="report_date"]').value]);
                data.push(['ä¸»ç®¡', document.querySelector('input[name="manager_name"]').value]);
                data.push(['ä»Šæ—¥å·¥æ™‚', document.querySelector('input[name="hours_worked"]').value, 'å°æ™‚']);
                data.push([]);

                // ç¬¬ä¸€éƒ¨åˆ†
                data.push(['ç¬¬ä¸€éƒ¨åˆ†ï¼šä»Šæ—¥ä»»å‹™æ‰¿è«¾èˆ‡é‡åŒ–ç›®æ¨™ï¼ˆä¸»ç®¡å¡«å¯«ï¼‰']);
                data.push(['ä»»å‹™é¡åˆ¥', 'æ ¸å¿ƒä»»å‹™', 'é è¨ˆå®Œæˆæ•¸é‡', 'é è¨ˆæ™‚é–“ï¼ˆåˆ†é˜ï¼‰']);
                const taskNames = ['é€²è²¨ç°½æ”¶', 'é€²è²¨ç•°å¸¸', 'é€€è²¨è™•ç†', 'é€€è²¨ä¸Šæ¶', 'åŒ…è£æ©Ÿæ“ä½œ', 'è²¼æ¨™ï¼é»‘è²¼', 'ç›¤é»', 'æ‹†è›‡çš®', 'æ•¸æ•¸é‡', 'é€²è²¨ä¸Šæ¶'];
                const taskCodes = ['rcv', 'exc', 'rma', 'rtp', 'pac', 'sec', 'inv', 'snk', 'cnt', 'stk'];
                taskCodes.forEach((code, index) => {
                    data.push([taskNames[index],
                        document.querySelector(`input[name="commit_${code}_task"]`).value,
                        document.querySelector(`input[name="commit_${code}_target"]`).value,
                        document.querySelector(`input[name="commit_${code}_minutes"]`).value
                    ]);
                });
                data.push([]);

                // ç¬¬äºŒéƒ¨åˆ†
                data.push(['ç¬¬äºŒéƒ¨åˆ†ï¼šå¯¦éš›ç”¢å‡ºã€å“è³ªèˆ‡ç´€å¾‹åˆ†æ']);
                data.push(['ä»»å‹™é¡åˆ¥', 'å¯¦éš›å®Œæˆæ•¸é‡', 'å¯¦éš›æ™‚é–“ï¼ˆåˆ†é˜ï¼‰', 'å“è³ªæª¢æ ¸ï¼ˆç…§SOP/å“è³ªï¼‰', 'å®Œæˆç‡', 'å·®è·åˆ†æ']);
                taskCodes.forEach((code, index) => {
                    const rate = document.querySelector(`.completion-rate[data-task="${code}"]`).textContent;
                    const quality1 = document.querySelector(`input[name="actual_${code}_quality_1"]`).checked ? 'âœ“' : 'âœ—';
                    const quality2 = document.querySelector(`input[name="actual_${code}_quality_2"]`).checked ? 'âœ“' : 'âœ—';
                    data.push([taskNames[index],
                        document.querySelector(`input[name="actual_${code}_output"]`).value,
                        document.querySelector(`input[name="actual_${code}_minutes"]`).value,
                        quality1 + ' ' + quality2,
                        rate,
                        document.querySelector(`input[name="actual_${code}_gap"]`).value
                    ]);
                });
                data.push([]);

                // ç¬¬ä¸‰éƒ¨åˆ†
                data.push(['ç¬¬ä¸‰éƒ¨åˆ†ï¼šé€æ˜åŒ–èˆ‡ç´€å¾‹å¼·åˆ¶ç´€éŒ„']);
                data.push(['å•é¡Œé¡å‹', 'å°è±¡', 'å•é¡Œå…§å®¹', 'è§£æ±ºæ–¹æ¡ˆ']);
                data.push(['è«‹ç›Šè¨˜éŒ„ 1',
                    document.querySelector('input[name="q_log1_target"]').value,
                    document.querySelector('input[name="q_log1_content"]').value,
                    document.querySelector('input[name="q_log1_solution"]').value
                ]);
                data.push(['è«‹ç›Šè¨˜éŒ„ 2',
                    document.querySelector('input[name="q_log2_target"]').value,
                    document.querySelector('input[name="q_log2_content"]').value,
                    document.querySelector('input[name="q_log2_solution"]').value
                ]);
                data.push(['è‡ªæˆ‘ç™¼ç¾çš„æµç¨‹å„ªåŒ–æ©Ÿæœƒ',
                    document.querySelector('input[name="q_log_opt_target"]').value,
                    document.querySelector('input[name="q_log_opt_content"]').value,
                    document.querySelector('input[name="q_log_opt_solution"]').value
                ]);
                data.push(['ä»Šæ—¥å­¸ç¿’åˆ°çš„æ–°çŸ¥è­˜/SOP',
                    document.querySelector('input[name="q_log_learn_target"]').value,
                    document.querySelector('input[name="q_log_learn_content"]').value,
                    document.querySelector('input[name="q_log_learn_solution"]').value
                ]);
                data.push([]);

                // ç¬¬å››éƒ¨åˆ†
                data.push(['ç¬¬å››éƒ¨åˆ†ï¼šæ–‡åŒ–èˆ‡æƒ…ç·’è‡ªè©•']);
                data.push(['è©•ä¼°é …ç›®', 'è©•åˆ†ï¼ˆ1-5åˆ†ï¼‰', 'èªªæ˜']);
                data.push(['1. æˆ‘ä»Šæ—¥æœ‰æ„è­˜åœ°éµå¾ªäº†æ‰€æœ‰æµç¨‹èˆ‡è¦ç¯„ã€‚',
                    document.querySelector('input[name="eval_discipline"]').value,
                    document.querySelector('input[name="eval_discipline_note"]').value
                ]);
                data.push(['2. æˆ‘è¦ºå¾—æˆ‘ä»Šå¤©çš„å·¥ä½œé€Ÿåº¦é”åˆ°äº†å…¬å¸è¦æ±‚çš„æ•ˆç‡ã€‚',
                    document.querySelector('input[name="eval_efficiency"]').value,
                    document.querySelector('input[name="eval_efficiency_note"]').value
                ]);
                data.push(['3. æˆ‘å°ä»Šæ—¥çš„é‡åŒ–ç›®æ¨™æ„Ÿåˆ°èˆˆå¥®è€Œéå£“åŠ›ã€‚',
                    document.querySelector('input[name="eval_value_fit"]').value,
                    document.querySelector('input[name="eval_value_fit_note"]').value
                ]);
                data.push(['4. æˆ‘èªç‚ºé€™ä»½å·¥ä½œå…§å®¹æ˜¯é©åˆæˆ‘çš„ã€‚',
                    document.querySelector('input[name="eval_commitment"]').value,
                    document.querySelector('input[name="eval_commitment_note"]').value
                ]);
                data.push([]);

                // ç¬¬äº”éƒ¨åˆ†
                data.push(['ç¬¬äº”éƒ¨åˆ†ï¼šæ¯é€±ç¸½çµèˆ‡ä¸»ç®¡å›é¥‹']);
                data.push(['æœ¬é€±å­¸ç¿’èˆ‡å„ªåŒ–å»ºè­°', document.querySelector('textarea[name="weekly_learnings"]').value]);
                data.push(['è·¨éƒ¨é–€å•é¡Œ', document.querySelector('textarea[name="weekly_relationship_issues"]').value]);
                data.push(['ä¸»ç®¡å›é¥‹', document.querySelector('textarea[name="manager_feedback"]').value]);

                // è½‰æ›ç‚ºCSV
                const csv = data.map(row => row.map(cell => `"${cell || ''}"`).join(',')).join('\n');
                const bom = '\uFEFF'; // UTF-8 BOM for Excel
                const blob = new Blob([bom + csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const fileName = `æ–°äººæ‰‹å†Š_å®Œæ•´_${document.querySelector('input[name="new_hire_name"]').value}_${document.querySelector('input[name="report_date"]').value}.csv`;
                a.download = fileName;
                a.click();
                URL.revokeObjectURL(url);
                alert('âœ“ Excelæª”æ¡ˆå·²åŒ¯å‡ºï¼');
            };
        });
    </script>
</head>
<body>

<form action="[YOUR_SUBMIT_URL]" method="POST">

<div class="report-title">é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - å“¡å·¥å¡«å¯«ç‰ˆ - è©¦ç”¨æœŸç¬¬ <input type="number" name="week_number" style="width: 50px;" readonly> é€±</div>

<div style="text-align: center; margin-bottom: 15px;">
    <button type="button" onclick="importManagerData()" style="padding: 12px 30px; font-size: 14pt; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ“¥ åŒ¯å…¥ä¸»ç®¡è³‡æ–™</button>
</div>

<div class="readonly-note">
    âš ï¸ ä»¥ä¸‹ç°è‰²å€åŸŸç”±ä¸»ç®¡å¡«å¯«ï¼Œåƒ…ä¾›æ‚¨åƒè€ƒï¼Œè«‹å‹¿ä¿®æ”¹
</div>

<table>
    <tr>
        <th style="width: 15%;">æ–°äººå§“å</th>
        <td><input type="text" name="new_hire_name" readonly></td>
        <th style="width: 10%;">æ—¥æœŸ</th>
        <td><input type="date" name="report_date" readonly></td>
    </tr>
    <tr>
        <th>ä¸»ç®¡</th>
        <td><input type="text" name="manager_name" readonly></td>
        <th>ä»Šæ—¥å·¥æ™‚</th>
        <td><input type="text" name="hours_worked" readonly> å°æ™‚</td>
    </tr>
</table>

<table class="readonly-section">
    <thead>
        <tr>
            <th colspan="4" class="section-header">ç¬¬ä¸€éƒ¨åˆ†ï¼šä»Šæ—¥ä»»å‹™æ‰¿è«¾èˆ‡é‡åŒ–ç›®æ¨™ï¼ˆä¸»ç®¡å·²å¡«å¯«ï¼‰</th>
        </tr>
        <tr>
            <th>ä»»å‹™é¡åˆ¥</th>
            <th>æ ¸å¿ƒä»»å‹™</th>
            <th>é è¨ˆå®Œæˆæ•¸é‡</th>
            <th>é è¨ˆæ™‚é–“<br>ï¼ˆåˆ†é˜ï¼‰</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>é€²è²¨ç°½æ”¶</td>
            <td><input type="text" name="commit_rcv_task" readonly></td>
            <td><input type="number" name="commit_rcv_target" class="target-input" data-task="rcv" readonly></td>
            <td><input type="number" name="commit_rcv_minutes" readonly></td>
        </tr>
        <tr>
            <td>é€²è²¨ç•°å¸¸</td>
            <td><input type="text" name="commit_exc_task" readonly></td>
            <td><input type="number" name="commit_exc_target" class="target-input" data-task="exc" readonly></td>
            <td><input type="number" name="commit_exc_minutes" readonly></td>
        </tr>
        <tr>
            <td>é€€è²¨è™•ç†</td>
            <td><input type="text" name="commit_rma_task" readonly></td>
            <td><input type="number" name="commit_rma_target" class="target-input" data-task="rma" readonly></td>
            <td><input type="number" name="commit_rma_minutes" readonly></td>
        </tr>
        <tr>
            <td>é€€è²¨ä¸Šæ¶</td>
            <td><input type="text" name="commit_rtp_task" readonly></td>
            <td><input type="number" name="commit_rtp_target" class="target-input" data-task="rtp" readonly></td>
            <td><input type="number" name="commit_rtp_minutes" readonly></td>
        </tr>
        <tr>
            <td>åŒ…è£æ©Ÿæ“ä½œ</td>
            <td><input type="text" name="commit_pac_task" readonly></td>
            <td><input type="number" name="commit_pac_target" class="target-input" data-task="pac" readonly></td>
            <td><input type="number" name="commit_pac_minutes" readonly></td>
        </tr>
        <tr>
            <td>è²¼æ¨™ï¼é»‘è²¼</td>
            <td><input type="text" name="commit_sec_task" readonly></td>
            <td><input type="number" name="commit_sec_target" class="target-input" data-task="sec" readonly></td>
            <td><input type="number" name="commit_sec_minutes" readonly></td>
        </tr>
        <tr>
            <td>ç›¤é»</td>
            <td><input type="text" name="commit_inv_task" readonly></td>
            <td><input type="number" name="commit_inv_target" class="target-input" data-task="inv" readonly></td>
            <td><input type="number" name="commit_inv_minutes" readonly></td>
        </tr>
        <tr>
            <td>æ‹†è›‡çš®</td>
            <td><input type="text" name="commit_snk_task" readonly></td>
            <td><input type="number" name="commit_snk_target" class="target-input" data-task="snk" readonly></td>
            <td><input type="number" name="commit_snk_minutes" readonly></td>
        </tr>
        <tr>
            <td>æ•¸æ•¸é‡</td>
            <td><input type="text" name="commit_cnt_task" readonly></td>
            <td><input type="number" name="commit_cnt_target" class="target-input" data-task="cnt" readonly></td>
            <td><input type="number" name="commit_cnt_minutes" readonly></td>
        </tr>
        <tr>
            <td>é€²è²¨ä¸Šæ¶</td>
            <td><input type="text" name="commit_stk_task" readonly></td>
            <td><input type="number" name="commit_stk_target" class="target-input" data-task="stk" readonly></td>
            <td><input type="number" name="commit_stk_minutes" readonly></td>
        </tr>
        <tr style="background-color: #ffe6e6; font-weight: bold;">
            <td colspan="3" style="text-align: right;">ç¸½è¨ˆæ™‚é–“ï¼š</td>
            <td><span id="total-time">0</span> åˆ†é˜</td>
        </tr>
    </tbody>
</table>

<div style="background-color: #d4edda; border: 2px solid #28a745; padding: 10px 15px; margin-bottom: 15px; border-radius: 8px; font-weight: bold; color: #155724; text-align: center;">
    âœï¸ ä»¥ä¸‹æ˜¯æ‚¨éœ€è¦å¡«å¯«çš„éƒ¨åˆ†
</div>

<table>
    <thead>
        <tr>
            <th colspan="6" class="section-header">ç¬¬äºŒéƒ¨åˆ†ï¼šå¯¦éš›ç”¢å‡ºã€å“è³ªèˆ‡ç´€å¾‹åˆ†æï¼ˆ<span style="background-color: #2196f3; padding: 2px 6px; border-radius: 3px; color: white; font-size: 11pt;">è—è‰²</span> è¡¨ç¤ºç•°å¸¸ï¼‰</th>
        </tr>
        <tr>
            <th>ä»»å‹™é¡åˆ¥</th>
            <th>å¯¦éš›å®Œæˆæ•¸é‡</th>
            <th>å¯¦éš›æ™‚é–“<br>ï¼ˆåˆ†é˜ï¼‰</th>
            <th class="quality-cell">å“è³ªæª¢æ ¸<br>ï¼ˆç…§SOPåŸ·è¡Œ/å“è³ªåˆæ ¼ï¼‰</th>
            <th>å®Œæˆç‡</th>
            <th>å·®è·åˆ†æ</th>
        </tr>
    </thead>
    <tbody>
        <tr><td>é€²è²¨ç°½æ”¶</td><td><input type="number" name="actual_rcv_output" class="actual-input" data-task="rcv"></td><td><input type="number" name="actual_rcv_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_rcv_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_rcv_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="rcv">0%</span></td><td><input type="text" name="actual_rcv_gap"></td></tr>
        <tr><td>é€²è²¨ç•°å¸¸</td><td><input type="number" name="actual_exc_output" class="actual-input" data-task="exc"></td><td><input type="number" name="actual_exc_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_exc_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_exc_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="exc">0%</span></td><td><input type="text" name="actual_exc_gap"></td></tr>
        <tr><td>é€€è²¨è™•ç†</td><td><input type="number" name="actual_rma_output" class="actual-input" data-task="rma"></td><td><input type="number" name="actual_rma_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_rma_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_rma_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="rma">0%</span></td><td><input type="text" name="actual_rma_gap"></td></tr>
        <tr><td>é€€è²¨ä¸Šæ¶</td><td><input type="number" name="actual_rtp_output" class="actual-input" data-task="rtp"></td><td><input type="number" name="actual_rtp_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_rtp_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_rtp_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="rtp">0%</span></td><td><input type="text" name="actual_rtp_gap"></td></tr>
        <tr><td>åŒ…è£æ©Ÿæ“ä½œ</td><td><input type="number" name="actual_pac_output" class="actual-input" data-task="pac"></td><td><input type="number" name="actual_pac_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_pac_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_pac_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="pac">0%</span></td><td><input type="text" name="actual_pac_gap"></td></tr>
        <tr><td>è²¼æ¨™ï¼é»‘è²¼</td><td><input type="number" name="actual_sec_output" class="actual-input" data-task="sec"></td><td><input type="number" name="actual_sec_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_sec_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_sec_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="sec">0%</span></td><td><input type="text" name="actual_sec_gap"></td></tr>
        <tr><td>ç›¤é»</td><td><input type="number" name="actual_inv_output" class="actual-input" data-task="inv"></td><td><input type="number" name="actual_inv_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_inv_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_inv_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="inv">0%</span></td><td><input type="text" name="actual_inv_gap"></td></tr>
        <tr><td>æ‹†è›‡çš®</td><td><input type="number" name="actual_snk_output" class="actual-input" data-task="snk"></td><td><input type="number" name="actual_snk_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_snk_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_snk_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="snk">0%</span></td><td><input type="text" name="actual_snk_gap"></td></tr>
        <tr><td>æ•¸æ•¸é‡</td><td><input type="number" name="actual_cnt_output" class="actual-input" data-task="cnt"></td><td><input type="number" name="actual_cnt_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_cnt_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_cnt_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="cnt">0%</span></td><td><input type="text" name="actual_cnt_gap"></td></tr>
        <tr><td>é€²è²¨ä¸Šæ¶</td><td><input type="number" name="actual_stk_output" class="actual-input" data-task="stk"></td><td><input type="number" name="actual_stk_minutes" min="0"></td><td class="quality-cell"><label class="quality-label"><input type="checkbox" name="actual_stk_quality_1" class="quality-checkbox" checked> ç…§SOPåŸ·è¡Œ</label><label class="quality-label"><input type="checkbox" name="actual_stk_quality_2" class="quality-checkbox" checked> å“è³ªåˆæ ¼</label></td><td><span class="completion-rate" data-task="stk">0%</span></td><td><input type="text" name="actual_stk_gap"></td></tr>
    </tbody>
</table>

<table>
    <thead>
        <tr>
            <th colspan="4" class="section-header">ç¬¬ä¸‰éƒ¨åˆ†ï¼šé€æ˜åŒ–èˆ‡ç´€å¾‹å¼·åˆ¶ç´€éŒ„</th>
        </tr>
        <tr>
            <th>å•é¡Œé¡å‹</th>
            <th>å°è±¡</th>
            <th>å•é¡Œå…§å®¹</th>
            <th>è§£æ±ºæ–¹æ¡ˆ</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>è«‹ç›Šè¨˜éŒ„ 1</td>
            <td><input type="text" name="q_log1_target"></td>
            <td><input type="text" name="q_log1_content"></td>
            <td><input type="text" name="q_log1_solution"></td>
        </tr>
        <tr>
            <td>è«‹ç›Šè¨˜éŒ„ 2</td>
            <td><input type="text" name="q_log2_target"></td>
            <td><input type="text" name="q_log2_content"></td>
            <td><input type="text" name="q_log2_solution"></td>
        </tr>
        <tr>
            <td>è‡ªæˆ‘ç™¼ç¾çš„æµç¨‹å„ªåŒ–æ©Ÿæœƒ</td>
            <td><input type="text" name="q_log_opt_target"></td>
            <td><input type="text" name="q_log_opt_content"></td>
            <td><input type="text" name="q_log_opt_solution"></td>
        </tr>
        <tr>
            <td>ä»Šæ—¥å­¸ç¿’åˆ°çš„æ–°çŸ¥è­˜/SOP</td>
            <td><input type="text" name="q_log_learn_target"></td>
            <td><input type="text" name="q_log_learn_content"></td>
            <td><input type="text" name="q_log_learn_solution"></td>
        </tr>
        <tr>
            <td colspan="4">
                <span class="red-note">ã€é›¶æ¨¡ç³Šè¦ç¯„ã€‘</span>
                è‹¥ã€Œè«‹ç›Šè¨˜éŒ„ã€æ¬„ä½ç©ºç™½ï¼Œå‰‡è¦–ç‚ºæ‚¨æœªéµå¾ªé€æ˜åŒ–å ±å‘Šçš„ç´€å¾‹è¦æ±‚ã€‚é€™å°‡ç›´æ¥å½±éŸ¿æ‚¨åœ¨è©¦ç”¨æœŸå…§ã€Œç´€å¾‹éµå¾ªã€è©•ä¼°é …ç›®çš„å¾—åˆ†ã€‚
            </td>
        </tr>
    </tbody>
</table>

<table>
    <thead>
        <tr>
            <th colspan="3" class="section-header">ç¬¬å››éƒ¨åˆ†ï¼šæ–‡åŒ–èˆ‡æƒ…ç·’è‡ªè©•</th>
        </tr>
        <tr>
            <th>è©•ä¼°é …ç›®</th>
            <th>è©•åˆ†<br>1åˆ†=å®Œå…¨æ²’æœ‰<br>5åˆ†=å®Œå…¨æœ‰</th>
            <th>èªªæ˜</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1. æˆ‘ä»Šæ—¥æœ‰æ„è­˜åœ°éµå¾ªäº†æ‰€æœ‰æµç¨‹èˆ‡è¦ç¯„ã€‚</td>
            <td><input type="number" name="eval_discipline" min="1" max="5"></td>
            <td><input type="text" name="eval_discipline_note"></td>
        </tr>
        <tr>
            <td>2. æˆ‘è¦ºå¾—æˆ‘ä»Šå¤©çš„å·¥ä½œé€Ÿåº¦é”åˆ°äº†å…¬å¸è¦æ±‚çš„æ•ˆç‡ã€‚</td>
            <td><input type="number" name="eval_efficiency" min="1" max="5"></td>
            <td><input type="text" name="eval_efficiency_note"></td>
        </tr>
        <tr>
            <td>3. æˆ‘å°ä»Šæ—¥çš„é‡åŒ–ç›®æ¨™æ„Ÿåˆ°èˆˆå¥®è€Œéå£“åŠ›ã€‚</td>
            <td><input type="number" name="eval_value_fit" min="1" max="5"></td>
            <td><input type="text" name="eval_value_fit_note"></td>
        </tr>
        <tr>
            <td>4. æˆ‘èªç‚ºé€™ä»½å·¥ä½œå…§å®¹æ˜¯é©åˆæˆ‘çš„ã€‚</td>
            <td><input type="number" name="eval_commitment" min="1" max="5"></td>
            <td><input type="text" name="eval_commitment_note"></td>
        </tr>
    </tbody>
</table>

<table class="page-break">
    <thead>
        <tr>
            <th colspan="2" class="section-header">ç¬¬äº”éƒ¨åˆ†ï¼šæ¯é€±ç¸½çµèˆ‡ä¸»ç®¡å›é¥‹</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th>æœ¬é€±å­¸ç¿’èˆ‡å„ªåŒ–å»ºè­°</th>
            <td><textarea name="weekly_learnings" rows="3"></textarea></td>
        </tr>
        <tr>
            <th>è·¨éƒ¨é–€å•é¡Œ</th>
            <td><textarea name="weekly_relationship_issues" rows="2"></textarea></td>
        </tr>
        <tr class="manager-review">
            <th>ä¸»ç®¡å›é¥‹</th>
            <td><textarea name="manager_feedback" rows="4" readonly placeholder="ç”±ä¸»ç®¡å¡«å¯«"></textarea></td>
        </tr>
    </tbody>
</table>

<div class="submit-container" style="text-align: center; margin-top: 30px;">
    <button type="button" onclick="submitToGoogleSheets()" style="padding: 15px 40px; font-size: 16pt; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">âœ… æäº¤åˆ° Google Sheets</button>
</div>

</form>
</body>
</html>
