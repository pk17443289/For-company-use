<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - ä¸»ç®¡å¡«å¯«ç‰ˆ</title>
    <style>
        /* åŸºç¤æ¨£å¼ */
        body {
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            margin: 30px auto;
            max-width: 1400px;
            font-size: 14pt;
            background-color: #f5f5f5;
            padding: 20px;
        }
        .report-title {
            text-align: center;
            font-size: 20pt;
            font-weight: bold;
            margin-bottom: 20px;
            color: #2c3e50;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            table-layout: auto;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            word-break: keep-all;
            overflow-wrap: break-word;
            white-space: normal;
            font-size: 13pt;
            line-height: 1.6;
        }
        th {
            background-color: #34495e;
            color: white;
            font-weight: bold;
        }
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            font-size: 15pt;
        }
        tbody tr:hover {
            background-color: #f8f9fa;
        }
        /* è¼¸å…¥æ¡†çš„æ¨™æº–æ¨£å¼ */
        input[type="text"], input[type="date"], input[type="number"], select {
            width: 98%;
            box-sizing: border-box;
            padding: 8px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13pt;
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            transition: border-color 0.3s;
        }
        /* è‡ªå‹•è¨ˆç®—çš„æ¬„ä½æ¨£å¼ */
        input.auto-calc {
            background-color: #f5f5f5;
            color: #666;
            cursor: not-allowed;
        }
        input[type="text"]:focus, input[type="date"]:focus,
        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        select {
            cursor: pointer;
        }
        /* åˆ—å°æ¨£å¼ */
        @media print {
            @page {
                size: A4 landscape;
                margin: 8mm 6mm 8mm 6mm;
            }
            body {
                margin: 0;
                padding: 0;
                font-size: 9pt;
                background-color: white;
                max-width: none;
            }
            .report-title {
                font-size: 14pt;
                font-weight: bold;
                margin-bottom: 8px;
                box-shadow: none;
                border-radius: 0;
                padding: 8px;
                border: 2px solid #2c3e50;
                background-color: #ecf0f1;
                color: #2c3e50;
            }
            table {
                box-shadow: none;
                border-radius: 0;
                margin-bottom: 12px;
                border: 2px solid #333;
            }
            .section-header {
                background-color: #5a6c7d !important;
                color: white !important;
                padding: 10px !important;
                font-size: 11pt !important;
                font-weight: bold !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            th {
                background-color: #34495e !important;
                color: white !important;
                font-weight: bold !important;
                padding: 5px 6px !important;
                font-size: 9pt !important;
                border: 1px solid #2c3e50 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            td {
                padding: 4px 6px;
                word-wrap: break-word;
                word-break: keep-all;
                overflow-wrap: break-word;
                white-space: normal;
                font-size: 8.5pt;
                line-height: 1.4;
                border: 1px solid #666 !important;
            }
            input[type="text"], input[type="date"], input[type="number"], select {
                border: none !important;
                background: none !important;
                padding: 0 !important;
                color: black !important;
                height: auto !important;
            }
            .submit-container, button {
                display: none !important;
            }
            #total-time, #time-warning {
                font-weight: bold;
            }
            table {
                page-break-inside: auto;
                table-layout: auto;
            }
            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
    <script>
        // è¨­å®šæ—¥æœŸç‚ºä»Šå¤©
        window.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            const dateString = `${year}-${month}-${day}`;
            document.querySelector('input[name="report_date"]').value = dateString;

            // è¨ˆç®—ç¸½æ™‚é–“
            function calculateTotalTime() {
                const timeInputs = document.querySelectorAll('.time-input');
                let total = 0;
                timeInputs.forEach(input => {
                    total += parseFloat(input.value) || 0;
                });

                const totalSpan = document.getElementById('total-time');
                const warningSpan = document.getElementById('time-warning');

                totalSpan.textContent = total;

                // è‡ªå‹•è¨ˆç®—ä»Šæ—¥å·¥æ™‚ï¼ˆåˆ†é˜è½‰å°æ™‚ï¼Œå››æ¨äº”å…¥åˆ°å°æ•¸é»ç¬¬1ä½ï¼‰
                const hoursWorked = (total / 60).toFixed(1);
                document.querySelector('input[name="hours_worked"]').value = hoursWorked;

                if (total >= 480) {
                    warningSpan.textContent = 'âœ“ æ­£ç¢º';
                    warningSpan.style.color = 'green';
                } else if (total > 0) {
                    warningSpan.textContent = 'âš  éœ€å¤§æ–¼ç­‰æ–¼480åˆ†é˜';
                    warningSpan.style.color = 'red';
                } else {
                    warningSpan.textContent = '';
                }
            }

            document.querySelectorAll('.time-input').forEach(input => {
                input.addEventListener('input', calculateTotalTime);
            });

            // è‡ªå‹•è¨ˆç®—é è¨ˆæ™‚é–“
            function autoCalculateTime() {
                document.querySelectorAll('.quantity-input').forEach(input => {
                    const quantity = parseFloat(input.value) || 0;
                    const unitTime = parseFloat(input.dataset.unitTime) || 0;
                    const task = input.dataset.task;
                    const timeInput = document.querySelector(`input[name="commit_${task}_minutes"]`);

                    if (timeInput && timeInput.classList.contains('auto-calc')) {
                        const totalTime = Math.round(quantity * unitTime);
                        timeInput.value = totalTime;
                        calculateTotalTime();
                    }
                });
            }

            // ç›£è½æ•¸é‡è¼¸å…¥æ¡†
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('input', autoCalculateTime);
            });

            // åˆå§‹åŒ–æ™‚è¨ˆç®—ç¸½æ™‚é–“
            calculateTotalTime();

            // åŒ¯å‡ºJSONçµ¦å“¡å·¥
            window.exportToEmployee = function() {
                // é©—è­‰å¿…å¡«æ¬„ä½
                const weekNumber = document.querySelector('input[name="week_number"]').value;
                const newHireName = document.querySelector('input[name="new_hire_name"]').value;
                const managerName = document.querySelector('select[name="manager_name"]').value;

                if (!weekNumber || !newHireName || !managerName) {
                    alert('âŒ ç„¡æ³•åŒ¯å‡ºï¼\nè«‹å¡«å¯«ä»¥ä¸‹å¿…å¡«æ¬„ä½ï¼š\n' +
                        (!weekNumber ? 'â€¢ è©¦ç”¨æœŸé€±æ•¸\n' : '') +
                        (!newHireName ? 'â€¢ æ–°äººå§“å\n' : '') +
                        (!managerName ? 'â€¢ ä¸»ç®¡\n' : ''));
                    return;
                }

                // é©—è­‰ç¸½è¨ˆæ™‚é–“æ˜¯å¦æ»¿480åˆ†é˜
                const totalTime = parseFloat(document.getElementById('total-time').textContent) || 0;
                if (totalTime < 480) {
                    const confirmed = confirm('âš ï¸ è­¦å‘Šï¼šç¸½è¨ˆæ™‚é–“ä¸è¶³8å°æ™‚\n\n' +
                        'ç›®å‰ç¸½è¨ˆï¼š' + totalTime + ' åˆ†é˜ï¼ˆ' + (totalTime / 60).toFixed(1) + ' å°æ™‚ï¼‰\n' +
                        'æ¨™æº–å·¥æ™‚ï¼š480 åˆ†é˜ï¼ˆ8.0 å°æ™‚ï¼‰\n\n' +
                        'ç¢ºå®šè¦ç¹¼çºŒåŒ¯å‡ºå—ï¼Ÿ');
                    if (!confirmed) {
                        return;
                    }
                }

                const data = {
                    week_number: weekNumber,
                    new_hire_name: newHireName,
                    report_date: document.querySelector('input[name="report_date"]').value,
                    manager_name: managerName,
                    hours_worked: document.querySelector('input[name="hours_worked"]').value,
                    tasks: {
                        rcv: {
                            task: document.querySelector('input[name="commit_rcv_task"]').value,
                            target: document.querySelector('input[name="commit_rcv_target"]').value,
                            minutes: document.querySelector('input[name="commit_rcv_minutes"]').value
                        },
                        exc: {
                            task: document.querySelector('input[name="commit_exc_task"]').value,
                            target: document.querySelector('input[name="commit_exc_target"]').value,
                            minutes: document.querySelector('input[name="commit_exc_minutes"]').value
                        },
                        rma: {
                            task: document.querySelector('input[name="commit_rma_task"]').value,
                            target: document.querySelector('input[name="commit_rma_target"]').value,
                            minutes: document.querySelector('input[name="commit_rma_minutes"]').value
                        },
                        rtp: {
                            task: document.querySelector('input[name="commit_rtp_task"]').value,
                            target: document.querySelector('input[name="commit_rtp_target"]').value,
                            minutes: document.querySelector('input[name="commit_rtp_minutes"]').value
                        },
                        pac: {
                            task: document.querySelector('input[name="commit_pac_task"]').value,
                            target: document.querySelector('input[name="commit_pac_target"]').value,
                            minutes: document.querySelector('input[name="commit_pac_minutes"]').value
                        },
                        sec: {
                            task: document.querySelector('input[name="commit_sec_task"]').value,
                            target: document.querySelector('input[name="commit_sec_target"]').value,
                            minutes: document.querySelector('input[name="commit_sec_minutes"]').value
                        },
                        inv: {
                            task: document.querySelector('input[name="commit_inv_task"]').value,
                            target: document.querySelector('input[name="commit_inv_target"]').value,
                            minutes: document.querySelector('input[name="commit_inv_minutes"]').value
                        },
                        snk: {
                            task: document.querySelector('input[name="commit_snk_task"]').value,
                            target: document.querySelector('input[name="commit_snk_target"]').value,
                            minutes: document.querySelector('input[name="commit_snk_minutes"]').value
                        },
                        cnt: {
                            task: document.querySelector('input[name="commit_cnt_task"]').value,
                            target: document.querySelector('input[name="commit_cnt_target"]').value,
                            minutes: document.querySelector('input[name="commit_cnt_minutes"]').value
                        },
                        stk: {
                            task: document.querySelector('input[name="commit_stk_task"]').value,
                            target: document.querySelector('input[name="commit_stk_target"]').value,
                            minutes: document.querySelector('input[name="commit_stk_minutes"]').value
                        }
                    }
                };

                const jsonStr = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `æ–°äººæ‰‹å†Š_${data.new_hire_name}_${data.report_date}.json`;
                a.click();
                URL.revokeObjectURL(url);
                alert('âœ“ è³‡æ–™å·²åŒ¯å‡ºï¼è«‹å°‡æª”æ¡ˆå‚³çµ¦å“¡å·¥ã€‚');
            };

            // åŒ¯å‡ºExcel
            window.exportToExcel = function() {
                // é©—è­‰å¿…å¡«æ¬„ä½
                const weekNumber = document.querySelector('input[name="week_number"]').value;
                const newHireName = document.querySelector('input[name="new_hire_name"]').value;
                const managerName = document.querySelector('select[name="manager_name"]').value;

                if (!weekNumber || !newHireName || !managerName) {
                    alert('âŒ ç„¡æ³•åŒ¯å‡ºï¼\nè«‹å¡«å¯«ä»¥ä¸‹å¿…å¡«æ¬„ä½ï¼š\n' +
                        (!weekNumber ? 'â€¢ è©¦ç”¨æœŸé€±æ•¸\n' : '') +
                        (!newHireName ? 'â€¢ æ–°äººå§“å\n' : '') +
                        (!managerName ? 'â€¢ ä¸»ç®¡\n' : ''));
                    return;
                }

                // é©—è­‰ç¸½è¨ˆæ™‚é–“æ˜¯å¦æ»¿480åˆ†é˜
                const totalTime = parseFloat(document.getElementById('total-time').textContent) || 0;
                if (totalTime < 480) {
                    const confirmed = confirm('âš ï¸ è­¦å‘Šï¼šç¸½è¨ˆæ™‚é–“ä¸è¶³8å°æ™‚\n\n' +
                        'ç›®å‰ç¸½è¨ˆï¼š' + totalTime + ' åˆ†é˜ï¼ˆ' + (totalTime / 60).toFixed(1) + ' å°æ™‚ï¼‰\n' +
                        'æ¨™æº–å·¥æ™‚ï¼š480 åˆ†é˜ï¼ˆ8.0 å°æ™‚ï¼‰\n\n' +
                        'ç¢ºå®šè¦ç¹¼çºŒåŒ¯å‡ºå—ï¼Ÿ');
                    if (!confirmed) {
                        return;
                    }
                }

                const data = [];

                // åŸºæœ¬è³‡è¨Š
                data.push(['é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - ä¸»ç®¡å¡«å¯«ç‰ˆ']);
                data.push(['è©¦ç”¨æœŸç¬¬', document.querySelector('input[name="week_number"]').value, 'é€±']);
                data.push([]);
                data.push(['æ–°äººå§“å', document.querySelector('input[name="new_hire_name"]').value]);
                data.push(['æ—¥æœŸ', document.querySelector('input[name="report_date"]').value]);
                data.push(['ä¸»ç®¡', document.querySelector('select[name="manager_name"]').value]);
                data.push(['ä»Šæ—¥å·¥æ™‚', document.querySelector('input[name="hours_worked"]').value, 'å°æ™‚']);
                data.push([]);

                // ç¬¬ä¸€éƒ¨åˆ†
                data.push(['ç¬¬ä¸€éƒ¨åˆ†ï¼šä»Šæ—¥ä»»å‹™æ‰¿è«¾èˆ‡é‡åŒ–ç›®æ¨™']);
                data.push(['ä»»å‹™é¡åˆ¥', 'æ ¸å¿ƒä»»å‹™', 'é è¨ˆå®Œæˆæ•¸é‡', 'é è¨ˆæ™‚é–“ï¼ˆåˆ†é˜ï¼‰']);
                data.push(['é€²è²¨ç°½æ”¶',
                    document.querySelector('input[name="commit_rcv_task"]').value,
                    document.querySelector('input[name="commit_rcv_target"]').value,
                    document.querySelector('input[name="commit_rcv_minutes"]').value
                ]);
                data.push(['é€²è²¨ç•°å¸¸',
                    document.querySelector('input[name="commit_exc_task"]').value,
                    document.querySelector('input[name="commit_exc_target"]').value,
                    document.querySelector('input[name="commit_exc_minutes"]').value
                ]);
                data.push(['é€€è²¨è™•ç†',
                    document.querySelector('input[name="commit_rma_task"]').value,
                    document.querySelector('input[name="commit_rma_target"]').value,
                    document.querySelector('input[name="commit_rma_minutes"]').value
                ]);
                data.push(['é€€è²¨ä¸Šæ¶',
                    document.querySelector('input[name="commit_rtp_task"]').value,
                    document.querySelector('input[name="commit_rtp_target"]').value,
                    document.querySelector('input[name="commit_rtp_minutes"]').value
                ]);
                data.push(['åŒ…è£æ©Ÿæ“ä½œ',
                    document.querySelector('input[name="commit_pac_task"]').value,
                    document.querySelector('input[name="commit_pac_target"]').value,
                    document.querySelector('input[name="commit_pac_minutes"]').value
                ]);
                data.push(['è²¼æ¨™ï¼é»‘è²¼',
                    document.querySelector('input[name="commit_sec_task"]').value,
                    document.querySelector('input[name="commit_sec_target"]').value,
                    document.querySelector('input[name="commit_sec_minutes"]').value
                ]);
                data.push(['ç›¤é»',
                    document.querySelector('input[name="commit_inv_task"]').value,
                    document.querySelector('input[name="commit_inv_target"]').value,
                    document.querySelector('input[name="commit_inv_minutes"]').value
                ]);
                data.push(['æ‹†è›‡çš®',
                    document.querySelector('input[name="commit_snk_task"]').value,
                    document.querySelector('input[name="commit_snk_target"]').value,
                    document.querySelector('input[name="commit_snk_minutes"]').value
                ]);
                data.push(['æ•¸æ•¸é‡',
                    document.querySelector('input[name="commit_cnt_task"]').value,
                    document.querySelector('input[name="commit_cnt_target"]').value,
                    document.querySelector('input[name="commit_cnt_minutes"]').value
                ]);
                data.push(['é€²è²¨ä¸Šæ¶',
                    document.querySelector('input[name="commit_stk_task"]').value,
                    document.querySelector('input[name="commit_stk_target"]').value,
                    document.querySelector('input[name="commit_stk_minutes"]').value
                ]);
                data.push(['ç¸½è¨ˆæ™‚é–“', '', '', document.getElementById('total-time').textContent]);

                // è½‰æ›ç‚ºCSV
                const csv = data.map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
                const bom = '\uFEFF'; // UTF-8 BOM for Excel
                const blob = new Blob([bom + csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const fileName = `æ–°äººæ‰‹å†Š_ä¸»ç®¡_${document.querySelector('input[name="new_hire_name"]').value}_${document.querySelector('input[name="report_date"]').value}.csv`;
                a.download = fileName;
                a.click();
                URL.revokeObjectURL(url);
                alert('âœ“ Excelæª”æ¡ˆå·²åŒ¯å‡ºï¼');
            };
        });
    </script>
</head>
<body>

<form action="[YOUR_SUBMIT_URL]" method="POST">

<div class="report-title">é›¶æ¨¡ç³Šæ–°äººæ—¥å ±è¡¨ - ä¸»ç®¡å¡«å¯«ç‰ˆ - è©¦ç”¨æœŸç¬¬ <input type="number" name="week_number" style="width: 50px;" required min="1"> é€±</div>

<table>
    <tr>
        <th style="width: 15%;">æ–°äººå§“å</th>
        <td><input type="text" name="new_hire_name"></td>
        <th style="width: 10%;">æ—¥æœŸ</th>
        <td><input type="date" name="report_date"></td>
    </tr>
    <tr>
        <th>ä¸»ç®¡</th>
        <td>
            <select name="manager_name" style="width: 100%; padding: 3px; font-size: 10pt;">
                <option value="">è«‹é¸æ“‡ä¸»ç®¡</option>
                <option value="éˆ´éˆº">éˆ´éˆº</option>
                <option value="å˜‰é§¿">å˜‰é§¿</option>
            </select>
        </td>
        <th>ä»Šæ—¥å·¥æ™‚</th>
        <td><input type="number" name="hours_worked" class="auto-calc" readonly style="width: 100px;"> å°æ™‚</td>
    </tr>
</table>

<table>
    <thead>
        <tr>
            <th colspan="4" class="section-header">ç¬¬ä¸€éƒ¨åˆ†ï¼šä»Šæ—¥ä»»å‹™æ‰¿è«¾èˆ‡é‡åŒ–ç›®æ¨™</th>
        </tr>
        <tr>
            <th>ä»»å‹™é¡åˆ¥</th>
            <th>æ ¸å¿ƒä»»å‹™</th>
            <th>é è¨ˆå®Œæˆæ•¸é‡</th>
            <th>é è¨ˆæ™‚é–“<br>ï¼ˆåˆ†é˜ï¼‰</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>é€²è²¨ç°½æ”¶</td>
            <td><input type="text" name="commit_rcv_task" value="ç¢ºèªå•†å“å®Œå…¨ç„¡èª¤"></td>
            <td><input type="number" name="commit_rcv_target" class="quantity-input" data-task="rcv" data-unit-time="0.63"></td>
            <td><input type="number" name="commit_rcv_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>é€²è²¨ç•°å¸¸</td>
            <td><input type="text" name="commit_exc_task" value="ç¢ºèªå•†å“è²¨æºå“ªè£¡å‡ºå•é¡Œ"></td>
            <td><input type="number" name="commit_exc_target" data-task="exc"></td>
            <td><input type="number" name="commit_exc_minutes" class="time-input" min="0" placeholder="æ‰‹å‹•è¼¸å…¥"></td>
        </tr>
        <tr>
            <td>é€€è²¨è™•ç†</td>
            <td><input type="text" name="commit_rma_task" value="ç¢ºä¿é€€çš„è²¨éƒ½æ­£ç¢ºç„¡ç•°å¸¸"></td>
            <td><input type="number" name="commit_rma_target" class="quantity-input" data-task="rma" data-unit-time="3"></td>
            <td><input type="number" name="commit_rma_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>é€€è²¨ä¸Šæ¶</td>
            <td><input type="text" name="commit_rtp_task" value="ç¢ºä¿å•†å“å¯ä»¥é¦¬ä¸Šå‡ºè²¨(ç„¡é«’æ±¡ç„¡å¤–è¢‹)"></td>
            <td><input type="number" name="commit_rtp_target" class="quantity-input" data-task="rtp" data-unit-time="0.66"></td>
            <td><input type="number" name="commit_rtp_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>åŒ…è£æ©Ÿæ“ä½œ</td>
            <td><input type="text" name="commit_pac_task" value="ç¢ºä¿å•†å“éåŒ…è£æ©Ÿç„¡ç•°å¸¸,æ­£ç¢ºä¸¦ç¢ºèª"></td>
            <td><input type="number" name="commit_pac_target" class="quantity-input" data-task="pac" data-unit-time="0.2"></td>
            <td><input type="number" name="commit_pac_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>è²¼æ¨™ï¼é»‘è²¼</td>
            <td><input type="text" name="commit_sec_task" value="ç¢ºä¿åŒ…è£æ©Ÿçš„å•†å“éƒ½æœ‰è²¼ä¸Šé»‘è²¼"></td>
            <td><input type="number" name="commit_sec_target" class="quantity-input" data-task="sec" data-unit-time="0.2"></td>
            <td><input type="number" name="commit_sec_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>ç›¤é»</td>
            <td><input type="text" name="commit_inv_task" value="ç¢ºä¿å‚™è²¨å•†å“è·Ÿå€‰ä½å•†å“æ•¸é‡æ­£ç¢º,æ²’æœ‰æ”¾éŒ¯å•†å“"></td>
            <td><input type="number" name="commit_inv_target" class="quantity-input" data-task="inv" data-unit-time="45"></td>
            <td><input type="number" name="commit_inv_minutes" class="time-input auto-calc" min="0" readonly></td>
        </tr>
        <tr>
            <td>æ‹†è›‡çš®</td>
            <td><input type="text" name="commit_snk_task" value="æ‹†è§£è›‡çš®è¢‹ä¸¦åˆ†é¡æ•´ç†"></td>
            <td><input type="number" name="commit_snk_target" data-task="snk"></td>
            <td><input type="number" name="commit_snk_minutes" class="time-input" min="0" placeholder="æ‰‹å‹•è¼¸å…¥"></td>
        </tr>
        <tr>
            <td>æ•¸æ•¸é‡</td>
            <td><input type="text" name="commit_cnt_task" value="æ¸…é»å•†å“æ•¸é‡ä¸¦æ ¸å°"></td>
            <td><input type="number" name="commit_cnt_target" data-task="cnt"></td>
            <td><input type="number" name="commit_cnt_minutes" class="time-input" min="0" placeholder="æ‰‹å‹•è¼¸å…¥"></td>
        </tr>
        <tr>
            <td>é€²è²¨ä¸Šæ¶</td>
            <td><input type="text" name="commit_stk_task" value="å°‡é€²è²¨å•†å“æ­£ç¢ºä¸Šæ¶è‡³æŒ‡å®šå€‰ä½"></td>
            <td><input type="number" name="commit_stk_target" data-task="stk"></td>
            <td><input type="number" name="commit_stk_minutes" class="time-input" min="0" placeholder="æ‰‹å‹•è¼¸å…¥"></td>
        </tr>
        <tr style="background-color: #ffe6e6; font-weight: bold;">
            <td colspan="3" style="text-align: right;">ç¸½è¨ˆæ™‚é–“ï¼š</td>
            <td><span id="total-time">0</span> åˆ†é˜ <span id="time-warning" style="color: red;"></span></td>
        </tr>
    </tbody>
</table>

<div class="submit-container" style="text-align: center; margin-top: 30px;">
    <button type="button" onclick="exportToEmployee()" style="padding: 15px 40px; font-size: 16pt; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; margin-right: 15px;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ“¤ åŒ¯å‡ºçµ¦å“¡å·¥</button>
    <button type="button" onclick="window.print()" style="padding: 15px 40px; font-size: 16pt; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">ğŸ–¨ï¸ åˆ—å°</button>
</div>

</form>
</body>
</html>
